<head>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-7VQPM3HPB7"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-7VQPM3HPB7');
    </script>

    <script>
    fetch('https://ipinfo.io/json?token=cfcaa1b98dabac')
    .then(response => response.json())
    .then(data => {
    console.log('User IP: ', data.ip);
    console.log('User Country: ', data.country);
    });
    </script>


<!--    <script src="https://apis.google.com/js/api.js"></script>-->
<!--    <script>-->
<!--      function initializeAnalytics() {-->
<!--        gapi.load('client:auth2', function() {-->
<!--          gapi.client.init({-->
<!--            apiKey: 'AIzaSyBtz4-iBiqGKhyl-oOT4EEgT1nRU6TTIFg',-->
<!--            clientId: '666279208057-1r3tact5mdueptnapoinmddtgd94hc82.apps.googleusercontent.com',-->
<!--            scope: 'https://www.googleapis.com/auth/analytics.readonly',-->
<!--            discoveryDocs: ['https://analyticsdata.googleapis.com/$discovery/rest?version=v1']-->
<!--          }).then(function() {-->
<!--            return gapi.client.analyticsdata.properties.runReport({-->
<!--              property: 'properties/449203991',-->
<!--              resource: {-->
<!--                dimensions: [{name: 'date'}],-->
<!--                metrics: [{name: 'screenPageViews'}],-->
<!--                dateRanges: [{startDate: '2020-07-07', endDate: 'today'}]-->
<!--              }-->
<!--            });-->
<!--          }).then(function(response) {-->
<!--            console.log('API response received', response);-->
<!--            if (response.result.rows.length > 0) {-->
<!--                var pageViews = response.result.rows[0].metrics[0].values[0];-->
<!--                document.getElementById('page-views').innerText = pageViews;-->
<!--            } else {-->
<!--                console.log('No data found');-->
<!--            }-->
<!--          }, function(error) {-->
<!--            console.log(error);-->
<!--          });-->
<!--        });-->
<!--      }-->
<!--      window.onload = initializeAnalytics;-->
<!--    </script>-->

    <script>
        // 定义一个函数来加载页面浏览量
        function loadPageViews(articleId) {
            // 替换这里的articleId为实际的文章ID，或者从URL中获取
            const url = `https://personalpage-express-mongodb.azurewebsites.net/pageviews/:articleId`;

            fetch(url)
                .then(response => {
                    if (!response.ok) {
                        throw new Error('Network response was not ok');
                    }
                    return response.json(); // 解析JSON响应
                })
                .then(data => {
                    // 更新页面上的元素以显示页面浏览量
                    document.getElementById('page-views').textContent = `${data.count}`;
                })
                .catch(error => {
                    console.error('There was a problem fetching the page views:', error);
                    document.getElementById('page-views').textContent = 'Error loading page views';
                });
        }

        // 假设你已经知道文章ID，或者从URL中解析它
        // 这里我们直接用一个示例ID
        const articleId = 'https://tommygong08.github.io/';

        // 页面加载完成后调用函数
        window.onload = function() {
            loadPageViews(articleId);
        };
    </script>

<!--    <meta charset="utf-8">-->
<!--    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">-->
    <meta name="description" content="">
    <meta name="author" content="">

    <title>
        {% if page.title %}
            {{ page.title }} &middot; {{ site.title }}
        {% else %}
            {{ site.title }}
        {% endif %}
    </title>

    <script src="{{ site.baseurl }}/theme/js/jquery-3.4.1.min.js"></script>
    <script src="{{ site.baseurl }}/theme/js/bootstrap-4.6.0.bundle.min.js"></script>

    <link rel="stylesheet" href="{{ site.baseurl }}/theme/css/site.css">
    <link rel="stylesheet" href="{{ site.baseurl }}/theme/css/syntax.css">

</head>
